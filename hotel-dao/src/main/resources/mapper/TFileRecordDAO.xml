<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gt.hotel.dao.TFileRecordDAO">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.gt.hotel.entity.TFileRecord">
        <id column="id" property="id"/>
        <result column="name" property="name"/>
        <result column="original_name" property="originalName"/>
        <result column="path" property="path"/>
        <result column="module" property="module"/>
        <result column="reference_id" property="referenceId"/>
        <result column="mark_modified" property="markModified"/>
        <result column="created_by" property="createdBy"/>
        <result column="created_at" property="createdAt"/>
        <result column="updated_by" property="updatedBy"/>
        <result column="updated_at" property="updatedAt"/>
        <result column="sub_module" property="subModule"/>
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id, name, original_name, path, module, reference_id, mark_modified, created_by, created_at, updated_by, updated_at, sub_module
    </sql>

    <select id="findRecordVoListByRefIdAndModule" resultType="com.gt.hotel.vo.FileRecordVo">
        SELECT
        <include refid="Base_Column_List"/>
        FROM t_file_record t
        WHERE t.module = #{module} AND t.reference_id = #{refId} AND t.mark_modified = 0
    </select>
    
    <update id="updateFileRecordMark">
    	UPDATE t_file_record 
    	SET mark_modified = #{file.markModified}, updated_by = #{file.updatedBy} 
    	WHERE mark_modified = #{mark} AND id IN 
    	<foreach collection="ids" index="index" item="item" open="(" separator="," close=")">
			#{item} 
    	</foreach>
    </update>
</mapper>
